@using BlazorOptions.ViewModels
@using Microsoft.AspNetCore.Components.Web
<MudStack Row="true" AlignItems="AlignItems.Center" Spacing="1" Class="mt-3 quick-add-panel">
    <MudTextField T="string"
                  @bind-Value="ViewModel.QuickLegInput"
                  Label="Quick add"
                  Placeholder="+1 C 3400"
                  Variant="Variant.Outlined"
                  Margin="Margin.Dense"
                  Immediate="true"
                  OnKeyDown="HandleQuickLegKeyDown"
                  Class="quick-leg-input" />

        <MudButton Variant="Variant.Filled"
                   Color="Color.Primary"
                   OnClick="async () => await ViewModel.AddQuickLegAsync()">
            Add
        </MudButton>
 
</MudStack>
@if (ViewModel.PreviewItems.Count > 0)
{
    <MudChipSet T="string" Class="quick-add-preview">
        @foreach (var preview in ViewModel.PreviewItems)
        {
            <MudChip T="string"
                     Color="@(preview.IsBuy ? Color.Success : Color.Error)"
                     Variant="Variant.Filled">
                @preview.Description
            </MudChip>
        }
    </MudChipSet>
}

@code {
    [Parameter, EditorRequired] public QuickAddViewModel ViewModel { get; set; }

    private Task HandleQuickLegKeyDown(KeyboardEventArgs args)
    {
        return ViewModel.OnQuickLegKeyDown(args.Key);
    }
}

<style>
    .quick-add-panel {
        flex-wrap: nowrap;
        min-height: 60px;
    }

    .quick-add-panel .quick-leg-input {
        width: 220px;
        flex: 0 0 220px;
    }

    .quick-add-preview {
        margin-left: 4px;
        margin-top: 6px;
    }
</style>
